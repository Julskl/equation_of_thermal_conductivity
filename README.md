##  Решение задачи теплопроводности для одномерного случая с помощью метода конечных разностей

Идея метода конечных разностей (МКР) состоит в следующем. Область непрерывного изменения аргументов заменяется расчетной сеткой - дискретным множеством точек (узлов). Вместо функции непрерывных аргументов вводятся функции дискретных аргументов - сеточные функции, определяемые в узлах сетки. Частные производные, входящие в дифференциальное уравнение и граничные условия, заменяются (аппроксимируются) разностными соотношениями.

В результате такой замены краевая задача в частных производных сводится к системе разностных (алгебраических) уравнений, называемых разностной схемой. Если решение системы разностных уравнений существует и при измельчении сетки стремится к решению поставленной задачи (т.е. сходится), то оно и является искомым численным решением краевой задачи.

В качестве примера применения метода конечных разностей рассмотрим краевую задачу на основе одномерного уравнения теплопроводности. Анализируется теплопередача через изолированный стержень. На одной границе cтержня поддерживается постоянная температура $U_п$ , на другой границе – температура $U_л$. Начальная температура равна $U_0$, источники тепловыделения внутри пластины отсутствуют.

Уравнение, которое будет описывать изменение температуры в стержне:

$$
ρс\frac{\partial U}{\partial t} = λ^2 \frac{\partial^2 U}{\partial x^2}
$$

Начальные и граничные условия запишутся следующим образом:

**Начальное условие** ($t=0$):
$$U(x, 0) = T_0, \quad 0 \le x \le L$$

**Граничное условие 1** ($x=0$):
$$U(0, t) = T_n, \quad t > 0$$

**Граничное условие 2** ($x=L$):
$$U(L, t) = T_n, \quad t > 0$$

Для того чтобы дать полное математическое описание рассматриваемой задачи, необходимо еще задать физические условия
однозначности. Если пластина изготовлена из стали, то λ = 46 Вт/(м⋅ºC), ρ = 7800 кг/м3, с = 460 Дж/(кг⋅ºC).

Разобьем стержень на N–1 равных промежутков, т.е. построим конечно-разностную сетку.


<p align="center">
   <img width="677" height="290" alt="aaa1d972c82936af88073482a0766554" src="https://github.com/user-attachments/assets/125947ef-8957-451e-93de-03103d5b7d2b" />
    <br>
</p>

Определим значение температуры в $i$-ом узле в момент времени $t=t_n = n \cdot \tau$ как $T(x_i, t_n) = T_i^n$. Здесь **$\tau$** — шаг интегрирования по временной координате, **$n$** — номер шага по времени.

### Система линейных алгебраических уравнений (СЛАУ)

Аппроксимация первой производной:

$$
\frac{\partial T}{\partial t} \approx \frac{T_i^{n+1} - T_i^n}{\tau}
$$

Аппроксимация второй производной:

$$
\frac{\partial^2 T}{\partial x^2} \approx \frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2}
$$

В результате аппроксимации частных производных соответствующими конечными разностями получаем следующую систему линейных алгебраических уравнений (СЛАУ):

$$\rho \cdot c \cdot \frac{T_i^{n+1} - T_i^n}{\tau} = \lambda \cdot \frac{T_{i+1}^{n} - 2 \cdot T_i^{n} + T_{i-1}^{n}}{h^2}, \quad i = 2, \dots, N-1, \quad n \ge 0. \quad (1)$$


Полная явная схема (подстановка в уравнение теплопроводности):

$$
T_i^{n+1} = T_i^n + \alpha \tau \left( \frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2} \right), \quad i=2,\dots,N-1, \ n \geq 0
$$

Где:
- $T_i^n$ — температура в узле $i$ на шаге $n$,
- $\tau$ — шаг по времени,
- $h$ — шаг по пространству,
- $\alpha$ — коэффициент теплопроводности.

Выбранную схему аппроксимации частных производных можно графически представить следующим образом:

<p align="center">
  <img width="456" height="324" alt="image" src="https://github.com/user-attachments/assets/28f8d694-e56c-41f8-acae-93c3fe1d4fea" />
    <br>
    <em> Рис. 3. Шаблон явной четырехточечной разностной схемы </em>
</p>

Рис. 3 демонстрирует, что используется четырехточечная разностная схема — три точки берутся на старом временном слое и одна с нового временного слоя.


Чтобы решение конечно-разностной задачи сходилось к решению дифференциальной задачи, достаточно выполнение следующего условия (условие устойчивости
разностной схемы):

$$\tau < \frac{\rho \cdot c \cdot h^2}{2 \cdot \lambda}$$

Из этого условия определяется шаг интегрирования по временной координате.


В данном репрозитории представлено решение данной задачи методом конечных разностей. 


## Структура репозитория

- **gnu_octave/**
  - `temp.m` — реализация метода конечных разностей в GNU Octave;

- **c_pthreads/**
  - `temp_calc.c` — МКР с использованием POSIX threads (pthreads);

- **c_mpi/**
  - `temp_calc_mpi.c` — МКР с использованием MPI (C);
  - `job1.sh` — пример SLURM-скрипта для запуска на кластере (112 MPI-процессов).

- **py_mpi/**
  - `temp_calc.py` — МКР реализация на Python с использованием `mpi4py` и `numpy`;
  - `job2.sh` — пример SLURM-скрипта для Python/MPI-версии.
 
- **c_openmp/**
  - `openMP.c` — МКР с помощью OpenMP;





















